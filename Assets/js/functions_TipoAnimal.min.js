function openModal(){document.querySelector("#idTipoAnimal").value="",document.querySelector(".modal-header").classList.replace("headerUpdate","headerRegister"),document.querySelector("#btnActionForm").classList.replace("btn-info","btn-primary"),document.querySelector("#btnText").innerHTML="Guardar",document.querySelector("#titleModal").innerHTML="Nuevo tipo de animal",document.querySelector("#formTipoAnimal").reset(),$("#modalFormTipoAnimal").modal("show"),rowTable="",removePhoto()}function fntViewTipoAnimal(e){let t=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),o=BaseUrl+"/TipoAnimal/GetTipoAnimal/"+e;t.open("GET",o,!0),t.send(),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){let e=JSON.parse(t.responseText);if(e.status){let t=1==e.data.estado?'<span class="badge badge-success">Activo</span>':'<span class="badge badge-danger">Inactivo</span>';document.querySelector("#celId").innerHTML=e.data.idTipoAnimal,document.querySelector("#celNombre").innerHTML=e.data.nombre,document.querySelector("#celDescripcion").innerHTML=e.data.descripcion,document.querySelector("#celEstado").innerHTML=t,document.querySelector("#imgAnimal").innerHTML='<img src="'+e.data.url_portada+'" width="300"></img>',$("#modalViewTipoAnimal").modal("show")}else swal("¡Error!",e.msg,"error")}}}function fntEditTipoAnimal(e,t){rowTable=e.parentNode.parentNode.parentNode,document.querySelector(".modal-header").classList.replace("headerRegister","headerUpdate"),document.querySelector("#btnActionForm").classList.replace("btn-primary","btn-info"),document.querySelector("#btnText").innerHTML="Actualizar",document.querySelector("#titleModal").innerHTML="Actualizar tipo animal";let o=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),a=BaseUrl+"/TipoAnimal/GetTipoAnimal/"+t;o.open("GET",a,!0),o.send(),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){let e=JSON.parse(o.responseText);e.status?(document.querySelector("#idTipoAnimal").value=e.data.idTipoAnimal,document.querySelector("#txtNombre").value=e.data.nombre,document.querySelector("#txtDescripcion").value=e.data.descripcion,document.querySelector("#foto_actual").value=e.data.img,document.querySelector("#foto_remove").value=0,1==e.data.status?document.querySelector("#listStatus").value=1:document.querySelector("#listStatus").value=2,$("#listStatus").selectpicker("refresh"),document.querySelector("#img")?document.querySelector("#img").src=e.data.url_portada:document.querySelector(".prevPhoto div").innerHTML='<img src="'+e.data.url_portada+'" width="300"></img>',"portada_categoria.png"==e.data.portada?document.querySelector(".delPhoto").classList.add("notBlock"):document.querySelector(".delPhoto").classList.remove("notBlock"),$("#modalFormTipoAnimal").modal("show")):swal("¡Error!",e.msg,"error")}}}function fntDelTipoAnimal(e){swal({title:"Eliminar Tipo animal",text:"¿Realente quiere eliminar el tipo de animal?",type:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"No, cancelar",closeOnConfirm:!1,closeOnCancel:!0},function(t){if(t){divLoading.style.display="flex";let t=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),o=BaseUrl+"/TipoAnimal/DelTipoAnimal/",a="idTipoAnimal="+e;t.open("POST",o,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(a),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){let e=JSON.parse(t.responseText);e.status?(swal("¡Eliminar!",e.msg,"success"),tableTipoAnimal.api().ajax.reload()):swal("¡Error!",e.msg,"error")}return divLoading.style.display="none",!1}}})}function removePhoto(){document.querySelector("#foto").value="",document.querySelector(".delPhoto").classList.add("notBlock"),document.querySelector("#img")&&document.querySelector("#img").remove()}let tableTipoAnimal,rowTable,divLoading=document.querySelector("#divLoading");document.addEventListener("DOMContentLoaded",function(){if(tableTipoAnimal=$("#tableTipoAnimal").dataTable({aProcessing:!0,aServerSide:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.20/i18n/Spanish.json"},ajax:{url:BaseUrl+"/TipoAnimal/GetTipoAnimales",dataSrc:""},columns:[{data:"idTipoAnimal"},{data:"nombre"},{data:"descripcion"},{data:"estado"},{data:"options"}],dom:"lBfrtip",buttons:[{extend:"copyHtml5",text:"<i class='fas fa-copy'></i> Copiar",titleAttr:"Copiar",className:"btn btn-secondary"},{extend:"excelHtml5",text:"<i class='fas fa-file-excel'></i> Excel",titleAttr:"Exportar a Excel",className:"btn btn-success"},{extend:"pdfHtml5",text:"<i class='fas fa-file-pdf'></i> PDF",titleAttr:"Exportar a PDF",className:"btn btn-danger"},{extend:"csvHtml5",text:"<i class='fas fa-file-csv'></i> CSV",titleAttr:"Exportar a CSV",className:"btn btn-info"}],responsive:"true",bDestroy:!0,iDisplayLength:10,order:[[1,"asc"]]}),document.querySelector("#foto")){let e=document.querySelector("#foto");e.onchange=function(t){let o=document.querySelector("#foto").value,a=document.querySelector("#foto").files,r=window.URL||window.webkitURL,n=document.querySelector("#form_alert");if(""!=o){let t=a[0].type;a[0].name;if("image/jpeg"!=t&&"image/jpg"!=t&&"image/png"!=t)return n.innerHTML='<p class="errorArchivo">El archivo no es válido.</p>',document.querySelector("#img")&&document.querySelector("#img").remove(),document.querySelector(".delPhoto").classList.add("notBlock"),e.value="",!1;{n.innerHTML="",document.querySelector("#img")&&document.querySelector("#img").remove(),document.querySelector(".delPhoto").classList.remove("notBlock");let e=r.createObjectURL(this.files[0]);document.querySelector(".prevPhoto div").innerHTML="<img id='img' src='"+e+"' width='300'>"}}else alert("No selecciono foto"),document.querySelector("#img")&&document.querySelector("#img").remove()}}if(document.querySelector(".delPhoto")){let e=document.querySelector(".delPhoto");e.onclick=function(e){document.querySelector("#foto_remove").value=1,removePhoto()}}let e=document.querySelector("#formTipoAnimal");e.onsubmit=function(t){t.preventDefault();let o=document.querySelector("#txtNombre").value,a=document.querySelector("#txtDescripcion").value,r=document.querySelector("#listStatus").value;document.querySelector("#foto").value;if(""==o||""==a||""==r)return swal("Atención","Todos los campos son obligatorios","error"),!1;divLoading.style.display="flex";let n=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),l=BaseUrl+"/TipoAnimal/SetTipoAnimal",i=new FormData(e);n.open("POST",l,!0),n.send(i),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){let t=JSON.parse(n.responseText);t.status?(""==rowTable?tableTipoAnimal.api().ajax.reload():(htmlStatus=1==r?'<span class="badge badge-success">Activo</span>':'<span class="badge badge-danger">Inactivo</span>',rowTable.cells[1].textContent=o,rowTable.cells[2].textContent=a,rowTable.cells[3].innerHTML=htmlStatus,rowTable=""),$("#modalFormTipoAnimal").modal("hide"),e.reset(),swal("Tipo de animal",t.msg,"success"),removePhoto()):swal("¡Error!",t.msg,"error")}return divLoading.style.display="none",!1}}},!1);