function fntPermisos(e){var t=e,o=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),a=BaseUrl+"/Permisos/GetPermisosRol/"+t;o.open("GET",a,!0),o.send(),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&(document.querySelector("#contentAjax").innerHTML=o.responseText,$(".modalPermisos").modal("show"),document.querySelector("#formPermisos").addEventListener("submit",fntSavePermisos,!1))}}function fntEditRol(e,t){rowTable=e.parentNode.parentNode.parentNode,document.querySelector(".modal-header").classList.replace("headerRegister","headerUpdate"),document.querySelector("#btnActionForm").classList.replace("btn-primary","btn-info"),document.querySelector("#btnText").innerHTML="Actualizar",document.querySelector("#titleModal").innerHTML="Actualizar Rol";let o=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),a=BaseUrl+"/Roles/GetRol/"+t;console.log(a),o.open("GET",a,!0),o.send(),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){let e=JSON.parse(o.responseText);e.estado?(document.querySelector("#idrol").value=e.data.idRol,document.querySelector("#txtNombre").value=e.data.nombreRol,document.querySelector("#txtDescripcion").value=e.data.descripcion,document.querySelector("#listStatus").value=e.data.estado,$("#listStatus").selectpicker("render"),$("#modalFormRol").modal("show")):swal("¡Error!",e.msg,"error")}}}function fntDelRol(e){swal({title:"Eliminar el Rol",text:"¿Realmente quiere eliminar el Rol?",type:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"No, cancelar",closeOnConfirm:!1,closeOnCancel:!0},function(t){if(t){divLoading.style.display="flex";let t=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),o=BaseUrl+"/Roles/DelRol/",a="idRol="+e;t.open("POST",o,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(a),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){let e=JSON.parse(t.responseText);e.estado?(swal("¡Eliminar!",e.msg,"success"),tableRoles.api().ajax.reload()):swal("¡Error!",e.msg,"error")}return divLoading.style.display="none",!1}}})}function fntSavePermisos(e){e.preventDefault();var t=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),o=BaseUrl+"/Permisos/SetPermisos/",a=document.querySelector("#formPermisos"),s=new FormData(a);t.open("POST",o,!0),t.send(s),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var e=JSON.parse(t.responseText);e.status?swal("¡Permisos de usuario!",e.msg,"success"):swal("¡Error!",e.msg,"error")}}}function openModal(){rowTable="",document.querySelector("#idrol").value="",document.querySelector(".modal-header").classList.replace("headerUpdate","headerRegister"),document.querySelector("#btnActionForm").classList.replace("btn-info","btn-primary"),document.querySelector("#btnText").innerHTML="Guardar",document.querySelector("#titleModal").innerHTML="Nuevo Rol",document.querySelector("#formRol").reset(),$("#modalFormRol").modal("show")}let tableRoles,rowTable,divLoading=document.querySelector("#divLoading");document.addEventListener("DOMContentLoaded",function(){tableRoles=$("#tableRoles").dataTable({aProcessing:!0,aServerSide:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.20/i18n/Spanish.json"},ajax:{url:BaseUrl+"/Roles/GetRoles",dataSrc:""},columns:[{data:"idRol"},{data:"nombreRol"},{data:"descripcion"},{data:"estado"},{data:"options"}],dom:"lBfrtip",buttons:[{extend:"copyHtml5",text:"<i class='fas fa-copy'></i> Copiar",titleAttr:"Copiar",className:"btn btn-secondary"},{extend:"excelHtml5",text:"<i class='fas fa-file-excel'></i> Excel",titleAttr:"Exportar a Excel",className:"btn btn-success"},{extend:"pdfHtml5",text:"<i class='fas fa-file-pdf'></i> PDF",titleAttr:"Exportar a PDF",className:"btn btn-danger"},{extend:"csvHtml5",text:"<i class='fas fa-file-csv'></i> CSV",titleAttr:"Exportar a CSV",className:"btn btn-info"}],responsive:"true",bDestroy:!0,iDisplayLength:10,order:[[1,"asc"]]});let e=document.querySelector("#formRol");e.onsubmit=function(t){t.preventDefault();let o=document.querySelector("#txtNombre").value,a=document.querySelector("#txtDescripcion").value,s=document.querySelector("#listStatus").value;if(""==o||""==a)return swal("Atención","Todos los campos son obligatorios","error"),!1;let r=document.getElementsByClassName("valid");for(let e=0;e<r.length;e++)if(r[e].classList.contains("is-invalid"))return swal("Atención","Por favor verifique los campos en rojo.","error"),!1;divLoading.style.display="flex";let n=window.XMLHttpRequest?XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),l=BaseUrl+"/Roles/SetRol",i=new FormData(e);n.open("POST",l,!0),n.send(i),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){console.log(n.responseText);let t=JSON.parse(n.responseText);t.estado?(""==rowTable?tableRoles.api().ajax.reload():(htmlStatus=1==s?'<span class="badge badge-success">Activo</span>':'<span class="badge badge-danger">Inactivo</span>',rowTable.cells[1].textContent=o,rowTable.cells[2].textContent=a,rowTable.cells[3].innerHTML=htmlStatus),$("#modalFormRol").modal("hide"),e.reset(),swal("Roles",t.msg,"success")):swal("¡Error!",t.msg,"error")}return divLoading.style.display="none",!1}}},!1);